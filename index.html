<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NamaHealing Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        #chat-container::-webkit-scrollbar { width: 8px; }
        #chat-container::-webkit-scrollbar-track { background: #f1f5f9; }
        #chat-container::-webkit-scrollbar-thumb { background-color: #94a3b8; border-radius: 10px; border: 3px solid #f1f5f9; }
    </style>
</head>
<body class="bg-slate-50 text-gray-800">
    <div id="app" class="flex flex-col h-screen">
        <header class="text-center py-6 sm:py-8 border-b border-slate-200"><h1 class="text-3xl sm:text-4xl font-bold text-teal-600">NamaHealing Bot</h1></header>
        <main id="chat-container" class="flex-1 overflow-y-auto p-4 sm:p-6"><div class="flex flex-col space-y-4 max-w-3xl mx-auto"><div class="bot-message self-start"><div class="bg-white rounded-xl rounded-tl-none p-4 shadow-md max-w-lg"><p class="text-base">Xin chào, tôi là trợ lý lớp thiền NamaHealing, tôi có thể giúp gì cho bạn?</p></div></div></div></main>
        <footer class="bg-white/80 backdrop-blur-sm border-t border-slate-200"><div class="max-w-3xl mx-auto p-4"><form id="chat-form" class="flex items-center space-x-2"><input id="message-input" type="text" placeholder="Nhập câu hỏi của bạn..." autocomplete="off" class="w-full py-3 px-4 bg-slate-100 border border-slate-200 rounded-full focus:outline-none focus:ring-2 focus:ring-teal-500 transition-shadow"><button type="submit" class="bg-teal-500 text-white rounded-full p-3 hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200 shadow-md hover:shadow-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button></form></div></footer>
    </div>
    <script>
        const chatContainer = document.getElementById('chat-container').querySelector('.space-y-4');
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const API_PROXY_URL = '/.netlify/functions/openai-proxy';
        const SYSTEM_PROMPT = `Bạn là trợ lý lớp thiền NamaHealing, dành riêng cho người đang gặp vấn đề tâm lý như trầm cảm, lo âu, stress, mất ngủ hoặc rối loạn cảm xúc. Lớp do kiến trúc sư Võ Trọng Nghĩa hướng dẫn và diễn ra trực tuyến qua Zoom.

Lớp thiền có thu phí và chỉ nhận học viên đang gặp vấn đề tâm lý. Người bình thường có thể đến chùa hoặc thiền viện để thực hành miễn phí.

Yêu cầu bắt buộc: học viên phải bật camera và micro khi tham gia lớp để thầy có thể quan sát và hướng dẫn trực tiếp.

Thời gian học:
– Sáng: 6:00 – 6:40 (Thứ 2 đến Chủ nhật)
– Tối: 20:45 – 21:30 (Thứ 2 đến Chủ nhật)

Học phí trọn khóa 20 buổi: 8.000.000 VND
Hỗ trợ còn 5.000.000 VND cho học viên khó khăn đang sinh sống tại Việt Nam.
Chuyển khoản đăng ký cho Trần Thị Mai Ly (Vietcombank 0371000429939), ghi rõ họ tên và số điện thoại.
Sau khi chuyển, điền form đăng ký và gửi biên lai qua Zalo 0839269501 để được xác nhận tài khoản.

Nếu câu trả lời chưa giải đáp hết thắc mắc, hãy hướng dẫn người học nhắn Zalo 0839269501 để gặp admin.

Khi nói về lợi ích của thiền, chỉ dựa trên chia sẻ của kiến trúc sư Võ Trọng Nghĩa:
• Thiền là liệu pháp tự nhiên giúp giảm nhanh các triệu chứng lo âu, trầm cảm và mất ngủ. Khi thiền, hormone cortisol giảm xuống, nhịp tim và huyết áp hạ, cơ thể thư giãn, tâm trí an định. Các sóng não Alpha và Theta xuất hiện, giúp đầu óc chậm lại và cơ thể bước vào trạng thái nghỉ sâu.
• Sau khoảng 8 tuần thực hành đều đặn (45 phút mỗi ngày), vùng chất xám ở vỏ não trước trán phát triển; amygdala (trung tâm sợ hãi) co lại; hippocampus (trí nhớ/cân bằng cảm xúc) tăng lên — lý giải vì sao triệu chứng cải thiện nhanh.
• Với người mất ngủ, thiền nằm trước khi ngủ giúp dễ ngủ và ngủ sâu; nhiều học viên giảm 90% triệu chứng sau 3–4 tuần (30% cải thiện ngay tuần đầu).
• Phương pháp NamaHealing phối hợp chánh niệm thân – hơi thở – từ bi (Metta) và luân phiên đi/đứng/ngồi/nằm khoảng 45 phút mỗi buổi; đổi đối tượng sau khoảng 5 phút để giữ tỉnh táo; có thể nghỉ ngắn 2–3 phút.
• Giáo viên duy trì định sâu (jhāna) khi hướng dẫn để bảo vệ bản thân và hỗ trợ học viên hồi phục nhanh hơn.
• Thiền không có tác dụng phụ như thuốc; “tác dụng phụ” đáng yêu là giúp học viên thông minh, điềm tĩnh và hạnh phúc hơn.

Luôn trả lời ấm áp, nhẹ nhàng, khích lệ; không đưa lời khuyên y khoa hay pháp lý. Nếu người dùng có triệu chứng nặng hoặc dấu hiệu tự hại, hãy khuyến khích họ gặp bác sĩ chuyên khoa.
`;
        const conversationHistory = [];

        function addMessage(message, sender) {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) loadingIndicator.remove();
            const messageElement = document.createElement('div');
            messageElement.classList.add(`${sender}-message`, 'self-start');
            let content = '';
            if (sender === 'user') {
                messageElement.classList.add('self-end');
                content = `<div class="bg-teal-500 text-white rounded-xl rounded-tr-none p-4 shadow-md max-w-lg"><p>${message}</p></div>`;
            } else if (sender === 'bot') {
                content = `<div class="bg-white rounded-xl rounded-tl-none p-4 shadow-md max-w-lg"><p>${message}</p></div>`;
            } else if (sender === 'loading') {
                messageElement.id = 'loading-indicator';
                content = `<div class="bg-white rounded-xl rounded-tl-none p-4 shadow-md max-w-lg"><div class="flex items-center space-x-2"><div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"></div><div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div><div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div></div></div>`;
            }
            messageElement.innerHTML = content;
            chatContainer.appendChild(messageElement);
            chatContainer.parentElement.scrollTop = chatContainer.parentElement.scrollHeight;
        }
        async function getBotResponse(userMessage) {
            addMessage('', 'loading');
            try {
                const response = await fetch(API_PROXY_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: userMessage,
                        systemPrompt: SYSTEM_PROMPT,
                        messages: [
                            ...conversationHistory,
                            { role: 'user', content: userMessage }
                        ]
                    })
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Lỗi không xác định từ server');
                }
                const data = await response.json();
                conversationHistory.push({ role: 'user', content: userMessage });
                conversationHistory.push({ role: 'assistant', content: data.reply });
                addMessage(data.reply, 'bot');
            } catch (error) {
                console.error('Error fetching bot response:', error);
                addMessage(`Xin lỗi, đã có lỗi xảy ra: ${error.message}`, 'bot');
            }
        }
        chatForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const userInput = messageInput.value.trim();
            if (userInput) {
                addMessage(userInput, 'user');
                messageInput.value = '';
                getBotResponse(userInput);
            }
        });
    </script>
</body>
</html>
